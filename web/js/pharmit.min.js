!function(e){e.support.cssPseudoClasses=function(){try{var t=e("<input type='checkbox' checked/>").appendTo("body"),n=e('<style type="text/css" />').appendTo("head");n.text("input:checked {width: 200px; display: none}");var a="200px"==t.css("width");return t.remove(),n.remove(),a}catch(i){return!1}}(),e.fn.fileinput=function(t){var n=this;return t||(t='<button class="fileinput">Browse...</button>'),n.each(function(){var n=e(this);n.wrap('<div class="fileinput-wrapper" style=" position: relative; display: inline-block;" />'),n.parent().mousemove(function(t){var n,a,i=e(this);n=i.offset().left,a=i.offset().top,i.find("input").css({left:t.pageX-n-i.find("input[type=file]").width()+30,top:t.pageY-a-10})}),n.attr("tabindex","-1").css({filter:"alpha(opacity=0)","-moz-opacity":0,opacity:0,position:"absolute","z-index":-1}),n.before(t),n.prev().addClass("fileinput"),e.support.cssPseudoClasses?(n.prev(".fileinput").click(function(){n.click()}),n.prev(":submit.fileinput").click(function(e){e.preventDefault()})):(n.css({"z-index":"auto",cursor:"pointer"}),n.prev(".fileinput").css("z-index",-1),n.removeAttr("tabindex"),n.prev(".fileinput").attr("tabindex","-1"),n.hover(function(){e(this).prev(".fileinput").addClass("hover")},function(){e(this).prev(".fileinput").removeClass("hover")}).focusin(function(){e(this).prev(".fileinput").addClass("focus")}).focusout(function(){e(this).prev(".fileinput").removeClass("focus")}).mousedown(function(){e(this).prev(".fileinput").addClass("active")}).mouseup(function(){e(this).prev(".fileinput").removeClass("active")}))}),n}}(jQuery);var Pharmit={};$(document).ready(function(){{var e=$("#pharmit"),t=new Pharmit.Viewer(e);new Pharmit.PharmaResults(e,t),new Pharmit.Query(e,t)}$("button, input[type='button'], input[type='submit']").button().bind("mouseup",function(){$(this).blur()})});var Pharmit=Pharmit||{};Pharmit.PharmaResults=function(){function e(){}return e}();var Pharmit=Pharmit||{};Pharmit.Query=function(){function e(e,t,n){var i=this;this.obj={},this.updateViewer=function(){},this.container=$("<div>").appendTo(t).addClass("featurediv"),this.container.feature=this,this.container.disableSelection();var o=$("<h3></h3>").appendTo(this.container);this.enabled=$("<div>").addClass("toggle toggle-light togglediv").appendTo(o).toggles().on("toggle",function(e,t){i.obj.enabled=t?!0:!1,i.updateViewer()}).click(function(){return!1});var r=$("<div>").addClass("featurenamediv").appendTo(o),s=$("<span>").addClass("featurenameheading").appendTo(r),d=$("<div>").addClass("featureclose").appendTo(o).click(function(){i.container.feature=null,i.container.remove()}),p=($("<span>").addClass("ui-icon-circle-close ui-icon").appendTo(d),$("<span>").appendTo(r).addClass("featuresummary"));p.append($(document.createTextNode("("))),this.xsummary=$("<span>").appendTo(p),p.append($(document.createTextNode(","))),this.ysummary=$("<span>").appendTo(p),p.append($(document.createTextNode(","))),this.zsummary=$("<span>").appendTo(p),p.append($(document.createTextNode(") Radius "))),this.rsummary=$("<span>").appendTo(p);var l=$("<div>").appendTo(this.container),u=this.select=$('<select name="featurename">').addClass("featureselect").appendTo(l);$.each(a,function(e,t){$('<option value="'+t+'">'+t+"</option>").appendTo(u)}),u.change(function(){var e=this.value;i.obj.name=e,s.text(e),"Aromatic"==e||"HydrogenDonor"==e||"HydrogenAcceptor"==e?(i.orientdiv.show(),i.sizediv.hide(),i.obj.hasvec=!0):"Hydrophobic"==e?(i.orientdiv.hide(),i.sizediv.show(),i.obj.hasvec=!1):(i.orientdiv.hide(),i.sizediv.hide(),i.obj.hasvec=!1),i.updateViewer()}),u.selectmenu({change:function(){u.trigger("change")}});var c=$("<div>").appendTo(l).addClass("locationdiv"),h=function(e,t){var n=function(){e.change()};return t.spin=t.stop=t.change=n,t};$("<label>x:</label>").appendTo(c),this.x=$("<input>").appendTo(c).addClass("coordinput").change(function(){var e=parseFloat(this.value);i.xsummary.text(numeral(e).format("0.[00]")),i.obj.x=e,i.updateViewer()}),this.x.spinner(h(i.x,{step:.1,numberFormat:"n"})),$("<label>y:</label>").appendTo(c),this.y=$("<input>").appendTo(c).addClass("coordinput"),this.y.spinner(h(i.y,{step:.1,numberFormat:"n"})).change(function(){var e=parseFloat(this.value);i.ysummary.text(numeral(e).format("0.[00]")),i.obj.y=e,i.updateViewer()}),$("<label>z:</label>").appendTo(c),this.z=$("<input>").appendTo(c).addClass("coordinput"),this.z.spinner(h(i.z,{step:.1,numberFormat:"n"})).change(function(){var e=parseFloat(this.value);i.zsummary.text(numeral(e).format("0.[00]")),i.obj.z=e,i.updateViewer()}),$("<label>Radius:</label>").appendTo(c),this.radius=$("<input>").appendTo(c).addClass("radiusinput"),this.radius.spinner(h(i.radius,{step:.1,numberFormat:"n"})).change(function(){i.rsummary.text(numeral(this.value).format("0.[00]")),i.obj.r=this.value,i.updateViewer()});var m=this.orientdiv=$("<div>").appendTo(l).addClass("orientdiv"),v=null,f=null,b=function(e,t){var n=e*Math.PI/180,a=t*Math.PI/180;i.obj.svector={x:Math.sin(n)*Math.cos(a),y:Math.sin(n)*Math.sin(a),z:Math.cos(n)}};this.orientenabled=$('<input type="checkbox">').appendTo(m).change(function(){$(this).prop("checked")?(v.spinner("option","disabled",!1),f.spinner("option","disabled",!1),i.obj.vector_on=0):(v.spinner("option","disabled",!0),f.spinner("option","disabled",!0),i.obj.vector_on=1,b(v.val(),f.val())),i.updateViewer()}),$("<label>&theta;:</label>").appendTo(m),v=this.theta=$("<input>").appendTo(m).addClass("orientinput"),this.theta.spinner(h(i.theta,{step:1,numberFormat:"n"})).change(function(){b(v.val(),f.val()),i.updateViewer()}),$("<label>&phi;:</label>").appendTo(m),f=this.phi=$("<input>").appendTo(m).addClass("orientinput"),this.phi.spinner(h(i.theta,{step:1,numberFormat:"n"})).change(function(){b(v.val(),f.val()),i.updateViewer()}),this.orientdiv.hide();var g=this.sizediv=$("<div>").appendTo(l).addClass("sizediv");this.minsize=$("<input>").appendTo(g).addClass("sizeinput"),this.minsize.spinner(h(i.minsize,{step:1,numberFormat:"n"})).change(function(){i.obj.minsize=this.value,i.updateViewer()}),$("<label> &le; #Atoms &le;</label>").appendTo(g),this.maxsize=$("<input>").appendTo(g).addClass("sizeinput"),this.maxsize.spinner(h(i.maxsize,{step:1,numberFormat:"n"})).change(function(){i.obj.maxsize=this.value,i.updateViewer()}),this.sizediv.hide(),this.setFeature(n),delete this.updateViewer,this.viewer=e,this.updateViewer(),t.accordion("refresh"),t.accordion("option","active",t.children().length-1)}function t(t,a){var i=$("<div>").addClass("pharmit_query"),o=null,r=null,s=null,d=null,p=null,l=null,u=null,c=function(){},h=function(e,t){if(e.files.length>0){var n=e.files[0],a=new FileReader;a.onload=function(e){t(e.target.result,n.name)},a.readAsText(n),$(e).val("")}},m=function(){},v=function(e,t){d=e,p=t,a.setReceptor(e,t)},f=function(){},b=function(t){var n=$.parseJSON(t);r.detach(),r.empty(),n.points&&$.each(n.points,function(t,n){new e(a,r,n)}),r.accordion("option","active",!1),r.accordion("refresh"),s.after(r),$.each(n,function(e,t){var n=$("input[name="+e+"]");n.length&&n.val(t)}),d=n.receptor,p=n.recname,a.setReceptor(d,p),n.sdf?(l=decodeURIComponent(n.sdf),u=l.match(/^@<TRIPOS>MOLECULE/)?".mol2":l.match(/^HETATM/)||l.match(/^ATOM/)?".pdb":l.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/)?".sdf":".xyz"):(l=n.ligand,u=n.ligandFormat),a.setLigand(l,u),a.setView(n.view)},g=function(){},y=function(e,t){var n=$("<div>").addClass("searchdiv"),a=$("<button>Search "+t[0]+"</button>").appendTo(n).button(),i=$("<button>Select subset to search</button>").appendTo(n).button({text:!1,icons:{primary:"ui-icon-triangle-1-s"}});n.buttonset();for(var o=$("<ul>").appendTo($("body")).addClass("floatmenu"),r=[],s=0,d=t.length;d>s;s++)r[s]="<li>"+t[s]+"</li>";o.append(r),o.hide().menu().on("menuselect",function(e,t){a.button("option","label","Search "+t.item.text())}),a.click(c),i.click(function(){var e=o.show().position({my:"left top",at:"left buttom",of:this});return $(document).one("click",function(){e.hide()}),!1}),e.prepend(n)};i.resizable({handles:"e"}),i.disableSelection();var T=$("<div>").appendTo(i).addClass("queryheader");y(T,["MolPort","ZINC"]);var x=$("<div>").appendTo(T),C=$("<button>Load Features...</button>").button(),w=$("<button>Load Receptor...</button>").button();t.append(i);$('<input type="file">').appendTo(x).fileinput(C).change(m),$('<input type="file">').appendTo(x).fileinput(w).change(function(){h(this,v)});i.detach();var z=$("<div>").appendTo(i).addClass("querybody"),k=$("<div>").appendTo(z);s=$("<div>Pharmacophore</div>").appendTo(k).addClass("queryheading"),r=$("<div>").appendTo(k),r.accordion({header:"> div > h3",animate:!0,collapsible:!0,heightStyle:"content"}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout"),$(this).accordion("refresh")}});var M=($("<button>Add</button>").appendTo(k).button({text:!0,icons:{secondary:"ui-icon-circle-plus"}}).click(function(){new e(a,r,n)}),$("<button>Sort</button>").appendTo(k).button({text:!0,icons:{secondary:"ui-icon ui-icon-carat-2-n-s"}}).click(f),$("<div>").appendTo(z));$("<div>Filters</div>").appendTo(M).addClass("queryheading");var P=$("<div>").appendTo(M),S=$("<h3>Hit Reduction<br></h3>").appendTo(P),V=($('<span class="headingsummary"></span>').appendTo(S),$('<div class="hitreduction"></div>').appendTo(P)),R=$("<div>").addClass("filterrow").appendTo(V);R.append('<label title="Maximum number of orientations returned for each conformation" value="1" for="reduceorienttext">Max Hits per Conf:</label>');$('<input id="reduceorienttext" name="max-orient">').appendTo(R).spinner();R=$("<div>").addClass("filterrow").appendTo(V),R.append('<label title="Maximum number of conformations returned for each compound" value="1" for="reduceconfstext">Max Hits per Mol:</label>');$('<input id="reduceconfstext" name="reduceConfs">').appendTo(R).spinner();R=$("<div>").addClass("filterrow").appendTo(V),R.append('<label title="Maximum number of hits returned" value="1" for="reducehitstext">Max Total Hits:</label>');$('<input id="reducehitstext" name="max-hits">').appendTo(R).spinner();S=$("<h3>Hit Screening<br></h3>").appendTo(P);var j=($('<span class="headingsummary"></span>').appendTo(S),$('<div class="hitscreening"></div>').appendTo(P));R=$("<div>").addClass("filterrow").appendTo(j);$('<input id="minmolweight" name="minMolWeight">').appendTo(R).spinner();R.append($('<label title="Minimum/maximum molecular weight (weights are approximate)" value="1" for="maxmolweight">&le;  Molecular Weight &le;</label>'));$('<input id="maxmolweight" name=maxMolWeight>').appendTo(R).spinner();R=$("<div>").addClass("filterrow").appendTo(j);$('<input id="minnrot" name="minrotbonds">').appendTo(R).spinner();R.append($('<label title="Minimum/maximum number of rotatable bonds" value="1" for="maxnrot"> &le;  Rotatable Bonds &le;</label>'));$('<input id="maxnrot" name="maxrotbonds">').appendTo(R).spinner();P.accordion({animate:!0,collapsible:!0,heightStyle:"content"}),o=$("<div>").appendTo(z),$("<div>Visualization</div>").appendTo(o).addClass("queryheading"),a.appendViewerControls(o);var F=$("<div>").appendTo(i).addClass("queryfooter");t.append(i);{var H=$("<button>Load Session...</button>").button();$('<input type="file">').appendTo(F).fileinput(H).change(function(){h(this,b)}),$("<button>Save Session...</button>").appendTo(F).button().click(g)}}var n={name:"Hydrophobic",x:0,y:0,z:0,radius:1,enabled:!0,vector_on:0,minsize:"",maxsize:"",svector:null,hasvec:!1},a=["Aromatic","HydrogenDonor","HydrogenAcceptor","Hydrophobic","NegativeIon","PositiveIon"];return e.prototype.setFeature=function(e){if(this.select.val(e.name).trigger("change"),this.select.selectmenu("refresh"),this.x.val(e.x).trigger("change"),this.y.val(e.y).trigger("change"),this.z.val(e.z).trigger("change"),this.radius.val(e.radius).trigger("change"),this.enabled.toggles(e.enabled),this.orientenabled.prop("checked",1==e.vector_on).trigger("change"),$.isNumeric(e.minsize)?this.minsize.val(e.minsize).trigger("change"):this.obj.minsize="",$.isNumeric(e.maxsize)?this.maxsize.val(e.maxsize).trigger("change"):this.obj.maxsize="",e.svector){var t=e.svector.x,n=e.svector.y,a=e.svector.z,i=180*Math.acos(a/Math.sqrt(t*t+n*n+a*a))/Math.PI,o=180*Math.atan2(n,t)/Math.PI;this.theta.val(i).trigger("change"),this.phi.val(o).trigger("change")}else this.obj.svector={x:1,y:0,z:0}},e.prototype.updateViewer=function(){},e.prototype.select=function(){},e.prototype.deselect=function(){},t}();var Pharmit=Pharmit||{};Pharmit.Viewer=function(){"use strict";function e(e){var t=($3Dmol.elementColors,{none:"None",rasmol:"RasMol",whiteCarbon:"White",greenCarbon:"Green",cyanCarbon:"Cyan",magentaCarbon:"Magenta",yellowCarbon:"Yellow",orangeCarbon:"Orange",purpleCarbon:"Purple",blueCarbon:"Blue"}),n={Ligand:{model:null,style:{stick:{radius:.15}}},Receptor:{model:null,style:{cartoon:{},line:{linewidth:3}}},Results:{model:null,style:{stick:{}}}},a={sphere:{radius:.2}},i=null,o={map:{prop:"partialCharge",scheme:new $3Dmol.Gradient.RWB(-.8,.8)},opacity:.8},r=null,s=function(e){if(!e)return"";var t=e.split(".");return t.length<=1?"":t.pop()},d=function(e,a,i){var o=$("<div>").appendTo(i),s=e+"MolStyleSelect";$('<label for="'+s+'">'+e+" Style</label>").appendTo(o).addClass("stylelabel");var d=$('<select name="'+s+'" id="'+s+'">').appendTo(o).addClass("styleselector");$.each(t,function(e,t){$('<option value="'+e+'">'+t+"</option>").appendTo(d)}),d.val(a),d.selectmenu({width:"8em",appendTo:i,change:function(){d.change()}}),d.change(function(){var t=this.value,a=n[e].style;$.each(a,function(e,n){n.colorscheme=t});var i=n[e].model;i&&i.setStyle({},a),d.selectmenu("refresh"),r.render()}),d.change()};this.appendViewerControls=function(e){d("Ligand","rasmol",e,null),d("Results","rasmol",e,null),d("Receptor","whiteCarbon",e,null),$('<label for="surfaceopacity">Receptor Surface Opacity</label>').appendTo(e);var t=$("<div>").addClass("surfacetransparencydiv").appendTo(e);$('<div id="surfaceopacity" name="surfaceopacity">').appendTo(t).slider({animate:"fast",step:.05,min:0,max:1,value:.8,change:function(e,t){o.opacity=t.value,null!==i&&r.setSurfaceMaterialStyle(i,o),r.render()}}),$('<label for="backgroundcolor">Background Color</label>').appendTo(e);var n=$('<div id="backgroundcolor">').appendTo(e);$('<input type="radio" id="whiteBackground" name="backgroundcolor"><label for="whiteBackground">White</label>').appendTo(n).change(function(){$(this).prop("checked")&&r.setBackgroundColor("white"),n.buttonset("refresh")}).prop("checked",!0),$('<input type="radio" id="blackBackground" name="backgroundcolor"><label for="blackBackground">Black</label>').appendTo(n).change(function(){$(this).prop("checked")&&r.setBackgroundColor("black"),n.buttonset("refresh")}),n.buttonset()},this.setReceptor=function(e,t){var d=n.Receptor.model;if(d&&r.removeModel(d),d=null,null!==i&&r.removeSurface(i),i=null,e){var p=s(t);d=r.addModel(e,p),d.setStyle({},n.Receptor.style),d.setStyle({bonds:0},a),n.Receptor.model=d,r.render(),r.mapAtomProperties($3Dmol.partialCharges),i=r.addSurface($3Dmol.SurfaceType.VDW,o,{model:d},{bonds:0,invert:!0})}r.zoomTo(),r.render()},this.setLigand=function(e,t){var a=n.Ligand.model;if(a&&r.removeModel(a),a=null,e){var i=s(t);a=r.addModel(e,i),a.setStyle({},n.Ligand.style),n.Ligand.model=a}r.zoomTo({model:a}),r.render()},this.setView=function(e){e&&r.setView(e)},this.getView=function(){return r.getView()},r=new $3Dmol.GLViewer(e),r.setBackgroundColor("white")}return e}();