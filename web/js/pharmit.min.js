!function(e){e.support.cssPseudoClasses=function(){try{var t=e("<input type='checkbox' checked/>").appendTo("body"),n=e('<style type="text/css" />').appendTo("head");n.text("input:checked {width: 200px; display: none}");var a="200px"==t.css("width");return t.remove(),n.remove(),a}catch(i){return!1}}(),e.fn.fileinput=function(t){var n=this;return t||(t='<button class="fileinput">Browse...</button>'),n.each(function(){var n=e(this);n.wrap('<div class="fileinput-wrapper" style=" position: relative; display: inline-block;" />'),n.parent().mousemove(function(t){var n,a,i=e(this);n=i.offset().left,a=i.offset().top,i.find("input").css({left:t.pageX-n-i.find("input[type=file]").width()+30,top:t.pageY-a-10})}),n.attr("tabindex","-1").css({filter:"alpha(opacity=0)","-moz-opacity":0,opacity:0,position:"absolute","z-index":-1}),n.before(t),n.prev().addClass("fileinput"),e.support.cssPseudoClasses?(n.prev(".fileinput").click(function(){n.click()}),n.prev(":submit.fileinput").click(function(e){e.preventDefault()})):(n.css({"z-index":"auto",cursor:"pointer"}),n.prev(".fileinput").css("z-index",-1),n.removeAttr("tabindex"),n.prev(".fileinput").attr("tabindex","-1"),n.hover(function(){e(this).prev(".fileinput").addClass("hover")},function(){e(this).prev(".fileinput").removeClass("hover")}).focusin(function(){e(this).prev(".fileinput").addClass("focus")}).focusout(function(){e(this).prev(".fileinput").removeClass("focus")}).mousedown(function(){e(this).prev(".fileinput").addClass("active")}).mouseup(function(){e(this).prev(".fileinput").removeClass("active")}))}),n}}(jQuery);var Pharmit={};$(document).ready(function(){{var e=$("#pharmit"),t=new Pharmit.Viewer(e);new Pharmit.PharmaResults(e,t),new Pharmit.Query(e,t)}$("button, input[type='button'], input[type='submit']").button().bind("mouseup",function(){$(this).blur()})});var Pharmit=Pharmit||{};Pharmit.PharmaResults=function(){function e(){}return e}();var Pharmit=Pharmit||{};Pharmit.Query=function(){function e(e,t,n){var i=this;this.obj={},this.updateViewer=function(){},this.container=$("<div>").appendTo(t).addClass("featurediv"),this.container.feature=this,this.container.disableSelection();var o=$("<h3></h3>").appendTo(this.container);this.enabled=$("<div>").addClass("toggle toggle-light togglediv").appendTo(o).toggles().on("toggle",function(e,t){i.obj.enabled=t?!0:!1,i.updateViewer()}).click(function(){return!1});var r=$("<div>").addClass("featurenamediv").appendTo(o),s=$("<span>").addClass("featurenameheading").appendTo(r),p=$("<div>").addClass("featureclose").appendTo(o).click(function(){i.container.feature=null,i.container.remove()}),d=($("<span>").addClass("ui-icon-circle-close ui-icon").appendTo(p),$("<span>").appendTo(r).addClass("featuresummary"));d.append($(document.createTextNode("("))),this.xsummary=$("<span>").appendTo(d),d.append($(document.createTextNode(","))),this.ysummary=$("<span>").appendTo(d),d.append($(document.createTextNode(","))),this.zsummary=$("<span>").appendTo(d),d.append($(document.createTextNode(") Radius "))),this.rsummary=$("<span>").appendTo(d);var l=$("<div>").appendTo(this.container),u=this.select=$('<select name="featurename">').addClass("featureselect").appendTo(l);$.each(a,function(e,t){$('<option value="'+t+'">'+t+"</option>").appendTo(u)}),u.change(function(){var e=this.value;i.obj.name=e,s.text(e),"Aromatic"==e||"HydrogenDonor"==e||"HydrogenAcceptor"==e?(i.orientdiv.show(),i.sizediv.hide(),i.obj.hasvec=!0):"Hydrophobic"==e?(i.orientdiv.hide(),i.sizediv.show(),i.obj.hasvec=!1):(i.orientdiv.hide(),i.sizediv.hide(),i.obj.hasvec=!1),i.updateViewer()}),u.selectmenu({change:function(){u.trigger("change")}});var c=$("<div>").appendTo(l).addClass("locationdiv"),h=function(e,t){var n=function(){e.change()};return t.spin=t.stop=t.change=n,t};$("<label>x:</label>").appendTo(c),this.x=$("<input>").appendTo(c).addClass("coordinput").change(function(){var e=parseFloat(this.value);i.xsummary.text(e.toFixed(2)),i.obj.x=e,i.updateViewer()}),this.x.spinner(h(i.x,{step:.1,numberFormat:"n"})),$("<label>y:</label>").appendTo(c),this.y=$("<input>").appendTo(c).addClass("coordinput"),this.y.spinner(h(i.y,{step:.1,numberFormat:"n"})).change(function(){var e=parseFloat(this.value);i.ysummary.text(e.toFixed(2)),i.obj.y=e,i.updateViewer()}),$("<label>z:</label>").appendTo(c),this.z=$("<input>").appendTo(c).addClass("coordinput"),this.z.spinner(h(i.z,{step:.1,numberFormat:"n"})).change(function(){var e=parseFloat(this.value);i.zsummary.text(e.toFixed(2)),i.obj.z=e,i.updateViewer()}),$("<label>Radius:</label>").appendTo(c),this.radius=$("<input>").appendTo(c).addClass("radiusinput"),this.radius.spinner(h(i.radius,{step:.1,numberFormat:"n"})).change(function(){i.rsummary.text(this.value),i.obj.r=this.value,i.updateViewer()});var m=this.orientdiv=$("<div>").appendTo(l).addClass("orientdiv"),v=null,f=null,b=function(e,t){var n=e*Math.PI/180,a=t*Math.PI/180;i.obj.svector={x:Math.sin(n)*Math.cos(a),y:Math.sin(n)*Math.sin(a),z:Math.cos(n)}};this.orientenabled=$('<input type="checkbox">').appendTo(m).change(function(){$(this).prop("checked")?(v.spinner("option","disabled",!1),f.spinner("option","disabled",!1),i.obj.vector_on=0):(v.spinner("option","disabled",!0),f.spinner("option","disabled",!0),i.obj.vector_on=1,b(v.val(),f.val())),i.updateViewer()}),$("<label>&theta;:</label>").appendTo(m),v=this.theta=$("<input>").appendTo(m).addClass("orientinput"),this.theta.spinner(h(i.theta,{step:1,numberFormat:"n"})).change(function(){b(v.val(),f.val()),i.updateViewer()}),$("<label>&phi;:</label>").appendTo(m),f=this.phi=$("<input>").appendTo(m).addClass("orientinput"),this.phi.spinner(h(i.theta,{step:1,numberFormat:"n"})).change(function(){b(v.val(),f.val()),i.updateViewer()}),this.orientdiv.hide();var g=this.sizediv=$("<div>").appendTo(l).addClass("sizediv");this.minsize=$("<input>").appendTo(g).addClass("sizeinput"),this.minsize.spinner(h(i.minsize,{step:1,numberFormat:"n"})).change(function(){i.obj.minsize=this.value,i.updateViewer()}),$("<label> &le; #Atoms &le;</label>").appendTo(g),this.maxsize=$("<input>").appendTo(g).addClass("sizeinput"),this.maxsize.spinner(h(i.maxsize,{step:1,numberFormat:"n"})).change(function(){i.obj.maxsize=this.value,i.updateViewer()}),this.sizediv.hide(),this.setFeature(n),delete this.updateViewer,this.viewer=e,this.updateViewer(),t.accordion("refresh"),t.accordion("option","active",t.children().length-1)}function t(t,a){var i=$("<div>").addClass("pharmit_query"),o=null,r=null,s=null,p=null,d=null,l=null,u=null,c=function(){},h=function(e,t){if(e.files.length>0){var n=e.files[0],a=new FileReader;a.onload=function(e){t(e.target.result,n.name)},a.readAsText(n)}},m=function(){},v=function(e,t){p=e,d=t,a.setReceptor(e,t)},f=function(){},b=function(t){var n=$.parseJSON(t);r.detach(),r.empty(),n.points&&$.each(n.points,function(t,n){new e(a,r,n)}),r.accordion("option","active",!1),r.accordion("refresh"),s.after(r),$.each(n,function(e,t){var n=$("input[name="+e+"]");n.length&&n.val(t)}),p=n.receptor,d=n.recname,a.setReceptor(p,d),a.sdf?(l=decodeURIComponent(n.sdf),u=l.match(/^@<TRIPOS>MOLECULE/)?"mol2":l.match(/^HETATM/)||l.match(/^ATOM/)?"pdb":l.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/)?"sdf":"xyz"):(l=n.ligand,u=n.ligandFormat),a.setLigand(l,u),a.setView(n.view)},g=function(){},T=function(e,t){var n=$("<div>").addClass("searchdiv"),a=$("<button>Search "+t[0]+"</button>").appendTo(n).button(),i=$("<button>Select subset to search</button>").appendTo(n).button({text:!1,icons:{primary:"ui-icon-triangle-1-s"}});n.buttonset();for(var o=$("<ul>").appendTo($("body")).addClass("floatmenu"),r=[],s=0,p=t.length;p>s;s++)r[s]="<li>"+t[s]+"</li>";o.append(r),o.hide().menu().on("menuselect",function(e,t){a.button("option","label","Search "+t.item.text())}),a.click(c),i.click(function(){var e=o.show().position({my:"left top",at:"left buttom",of:this});return $(document).one("click",function(){e.hide()}),!1}),e.prepend(n)};i.resizable({handles:"e"}),i.disableSelection();var y=$("<div>").appendTo(i).addClass("queryheader");T(y,["MolPort","ZINC"]);var x=$("<div>").appendTo(y),C=$("<button>Load Features...</button>").button(),w=$("<button>Load Receptor...</button>").button();t.append(i);$('<input type="file">').appendTo(x).fileinput(C).change(m),$('<input type="file">').appendTo(x).fileinput(w).change(function(){h(this,v)});i.detach();var z=$("<div>").appendTo(i).addClass("querybody"),M=$("<div>").appendTo(z);s=$("<div>Pharmacophore</div>").appendTo(M).addClass("queryheading"),r=$("<div>").appendTo(M),r.accordion({header:"> div > h3",animate:!0,collapsible:!0,heightStyle:"content"}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout"),$(this).accordion("refresh")}});var P=($("<button>Add</button>").appendTo(M).button({text:!0,icons:{secondary:"ui-icon-circle-plus"}}).click(function(){new e(a,r,n)}),$("<button>Sort</button>").appendTo(M).button({text:!0,icons:{secondary:"ui-icon ui-icon-carat-2-n-s"}}).click(f),$("<div>").appendTo(z));$("<div>Filters</div>").appendTo(P).addClass("queryheading");var V=$("<div>").appendTo(P),F=$("<h3>Hit Reduction<br></h3>").appendTo(V),j=($('<span class="headingsummary"></span>').appendTo(F),$('<div class="hitreduction"></div>').appendTo(V)),k=$("<div>").addClass("filterrow").appendTo(j);k.append('<label title="Maximum number of orientations returned for each conformation" value="1" for="reduceorienttext">Max Hits per Conf:</label>');$('<input id="reduceorienttext" name="max-orient">').appendTo(k).spinner();k=$("<div>").addClass("filterrow").appendTo(j),k.append('<label title="Maximum number of conformations returned for each compound" value="1" for="reduceconfstext">Max Hits per Mol:</label>');$('<input id="reduceconfstext" name="reduceConfs">').appendTo(k).spinner();k=$("<div>").addClass("filterrow").appendTo(j),k.append('<label title="Maximum number of hits returned" value="1" for="reducehitstext">Max Total Hits:</label>');$('<input id="reducehitstext" name="max-hits">').appendTo(k).spinner();F=$("<h3>Hit Screening<br></h3>").appendTo(V);var S=($('<span class="headingsummary"></span>').appendTo(F),$('<div class="hitscreening"></div>').appendTo(V));k=$("<div>").addClass("filterrow").appendTo(S);$('<input id="minmolweight" name="minMolWeight">').appendTo(k).spinner();k.append($('<label title="Minimum/maximum molecular weight (weights are approximate)" value="1" for="maxmolweight">&le;  Molecular Weight &le;</label>'));$('<input id="maxmolweight" name=maxMolWeight>').appendTo(k).spinner();k=$("<div>").addClass("filterrow").appendTo(S);$('<input id="minnrot" name="minrotbonds">').appendTo(k).spinner();k.append($('<label title="Minimum/maximum number of rotatable bonds" value="1" for="maxnrot"> &le;  Rotatable Bonds &le;</label>'));$('<input id="maxnrot" name="maxrotbonds">').appendTo(k).spinner();V.accordion({animate:!0,collapsible:!0,heightStyle:"content"}),o=$("<div>").appendTo(z),$("<div>Visualization</div>").appendTo(o).addClass("queryheading"),a.appendViewerControls(o);var R=$("<div>").appendTo(i).addClass("queryfooter");t.append(i);{var H=$("<button>Load Session...</button>").button();$('<input type="file">').appendTo(R).fileinput(H).change(function(){h(this,b)}),$("<button>Save Session...</button>").appendTo(R).button().click(g)}}var n={name:"Hydrophobic",x:0,y:0,z:0,radius:1,enabled:!0,vector_on:0,minsize:"",maxsize:"",svector:null,hasvec:!1},a=["Aromatic","HydrogenDonor","HydrogenAcceptor","Hydrophobic","NegativeIon","PositiveIon"];return e.prototype.setFeature=function(e){if(this.select.val(e.name).trigger("change"),this.select.selectmenu("refresh"),this.x.val(e.x).trigger("change"),this.y.val(e.y).trigger("change"),this.z.val(e.z).trigger("change"),this.radius.val(e.radius).trigger("change"),this.enabled.toggles(e.enabled),this.orientenabled.prop("checked",1==e.vector_on).trigger("change"),$.isNumeric(e.minsize)?this.minsize.val(e.minsize).trigger("change"):this.obj.minsize="",$.isNumeric(e.maxsize)?this.maxsize.val(e.maxsize).trigger("change"):this.obj.maxsize="",e.svector){var t=e.svector.x,n=e.svector.y,a=e.svector.z,i=180*Math.acos(a/Math.sqrt(t*t+n*n+a*a))/Math.PI,o=180*Math.atan2(n,t)/Math.PI;this.theta.val(i).trigger("change"),this.phi.val(o).trigger("change")}else this.obj.svector={x:1,y:0,z:0}},e.prototype.updateViewer=function(){},e.prototype.select=function(){},e.prototype.deselect=function(){},t}();var Pharmit=Pharmit||{};Pharmit.Viewer=function(){function e(e){var t=$3Dmol.elementColors,n=[{name:"None",color:null},{name:"RasMol",color:t.rasmol},{name:"White",color:t.whiteCarbon},{name:"Green",color:t.greenCarbon},{name:"Cyan",color:t.cyanCarbon},{name:"Magenta",color:t.magentaCarbon},{name:"Yellow",color:t.yellowCarbon},{name:"Orange",color:t.orangeCarbon},{name:"Purple",color:t.purpleCarbon},{name:"Blue",color:t.blueCarbon}],a=null,i=null,o=function(e){if(!e)return"";var t=e.split(".");return t.length<=1?"":t.pop()},r=function(e,t){var a=$("<div>"),i=e+"MolStyleSelect";$('<label for="'+i+'">'+e+" Style</label>").appendTo(a).addClass("stylelabel");for(var o=$('<select name="'+i+'" id="'+i+'">').appendTo(a).addClass("styleselector"),r=0,s=n.length;s>r;r++)$('<option value="'+n[r].name.toLowerCase()+'">'+n[r].name+"</option>").appendTo(o);return o.val(t),o.selectmenu({width:120}),a};this.appendViewerControls=function(e){r("Ligand",1,null).appendTo(e),r("Results",1,null).appendTo(e),r("Receptor",2,null).appendTo(e),$('<label for="surfacetransparency">Receptor Surface Opacity</label>').appendTo(e);var t=$("<div>").addClass("surfacetransparencydiv").appendTo(e);$('<div id="surfacetransparency">').appendTo(t).slider({animate:"fast",step:.05,min:0,max:1,value:.8})},this.setReceptor=function(e,t){if(e){var n=o(t);i=a.addModel(e,n)}else i&&a.removeModel(i),i=null;a.zoomTo(),a.render()},this.setLigand=function(){if(recstr){var e=o(recname);i=a.addModel(recstr,e)}else i&&a.removeModel(i),i=null;a.zoomTo(),a.render()},this.setView=function(e){e&&a.setView(e)},this.getView=function(){return a.getView()},a=new $3Dmol.GLViewer(e),a.setBackgroundColor("white")}return e}();